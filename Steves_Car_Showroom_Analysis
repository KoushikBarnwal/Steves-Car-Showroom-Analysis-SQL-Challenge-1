--SELECT * FROM cars;
--SELECT * FROM salespersons;
--SELECT * FROM sales;

--1. What are the details of all cars purchased in the year 2022?

/*SELECT 
c.car_id,c.make,c.type,c.style,c.cost_$,
s.purchase_date
FROM cars c
LEFT JOIN sales s
ON c.car_id = s.car_id
WHERE YEAR(s.purchase_date) = 2022;*/

--2. What is the total number of cars sold by each salesperson?

/*SELECT sp.salesman_id, sp.name, 
COUNT(s.car_id) AS TotalCarsSold
FROM salespersons sp
LEFT JOIN sales s 
ON sp.salesman_id = s.salesman_id
GROUP BY sp.salesman_id, sp.name;*/

--3. What is the total revenue generated by each salesperson?

/*SELECT sp.salesman_id, sp.name, 
SUM(c.cost_$) AS Total_Revenue 
FROM cars c
LEFT JOIN sales s 
ON c.car_id = s.car_id
LEFT JOIN salespersons sp 
ON s.salesman_id = sp.salesman_id
GROUP BY sp.salesman_id, sp.name
ORDER BY Total_Revenue DESC;*/

--4. What are the details of the cars sold by each salesperson?

/*SELECT sp.salesman_id, sp.name,c.* FROM cars c
LEFT JOIN sales s ON c.car_id = s.car_id
LEFT JOIN salespersons sp ON s.salesman_id = sp.salesman_id
ORDER BY sp.salesman_id;*/

--5. What is the total revenue generated by each car type?

/*SELECT c.car_id,c.type, SUM(c.cost_$) AS Total_Revenue FROM cars c
LEFT JOIN sales s ON c.car_id = s.car_id
GROUP BY c.car_id,c.type;*/

--6. What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?

/*SELECT c.* FROM cars c
LEFT JOIN sales s ON c.car_id = s.car_id
LEFT JOIN salespersons sp ON s.salesman_id = sp.salesman_id
WHERE YEAR(s.purchase_date) = 2021 AND sp.name = 'Emily Wong';*/

--7. What is the total revenue generated by the sales of hatchback cars?

/*SELECT c.style, SUM(c.cost_$) AS Total_Revenue FROM cars c
LEFT JOIN sales s
ON c.car_id = s.car_id
WHERE c.style = 'Hatchback'
GROUP BY c.style;*/

--8. What is the total revenue generated by the sales of SUV cars in the year 2022?

/*SELECT c.style, SUM(cost_$) AS Total_Revenue FROM cars c
LEFT JOIN sales s
ON c.car_id = s.car_id
WHERE c.style = 'SUV' AND YEAR(s.purchase_date) = 2022
GROUP BY c.style;*/

--9. What is the name and city of the salesperson who sold the most number of cars in the year 2023?

/*WITH cte AS(
	SELECT sp.name AS name, sp.city AS city, 
	COUNT(s.car_id) AS cnt FROM salespersons sp
	LEFT JOIN sales s
	ON sp.salesman_id = s.salesman_id
	WHERE YEAR(s.purchase_date) = 2023
	GROUP BY sp.name, sp.city)
SELECT name, city FROM cte 
WHERE cnt >=(SELECT MAX(cnt) FROM cte)*/

--10. What is the name and age of the salesperson who generated the highest revenue in the year 2022?

/*WITH cte AS (
SELECT sp.name AS Name, sp.age AS Age, SUM(c.cost_$) AS Total_Revenue
FROM salespersons sp
LEFT JOIN sales s
ON sp.salesman_id = s.salesman_id
LEFT JOIN cars c
ON s.car_id = c.car_id
WHERE YEAR(s.purchase_date) = 2022
GROUP BY sp.name, sp.age)

SELECT Name, Age FROM cte 
WHERE Total_Revenue = (SELECT MAX(Total_Revenue) FROM cte)*/


